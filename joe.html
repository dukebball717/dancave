<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Man Cave Live Scores</title>
<style>
  body {
    margin: 0;
    background: #000;
    color: #0f0;
    font-family: Arial, sans-serif;
    overflow: hidden;
  }
  h1 { font-size: 3em; text-align: center; margin: 20px 0; }
  .league-title { font-size: 2em; text-align: center; margin: 20px 0; color: #fff; }
  .scores-container { display: flex; flex-direction: column; align-items: center; width: 100%; }
  .game { display: flex; justify-content: space-around; align-items: center; width: 90%; margin: 20px 0; font-size: 1.8em; }
  .team { display: flex; flex-direction: column; align-items: center; width: 200px; }
  .team img { max-width: 100px; height: auto; margin-bottom: 10px; }
  .score { font-size: 2em; font-weight: bold; width: 200px; text-align: center; }
</style>
</head>
<body>
<h1>Man Cave Live Scores</h1>
<div id="scores" class="scores-container">Loading...</div>

<script>
const API_KEY = '465991830f2ae7dc89008520ae572097';
const REFRESH_MS = 60000; // 60 seconds

// Each league with proper endpoint info
const LEAGUES = [
  {
    code: 'american-football-nfl',
    title: 'NFL Football',
    parseScore: (game) => {
      const home = game.scores?.home ?? 0;
      const away = game.scores?.away ?? 0;
      return `${home} - ${away}`;
    }
  },
  {
    code: 'baseball-mlb',
    title: 'MLB Baseball',
    parseScore: (game) => {
      const home = game.scores?.home?.runs ?? 0;
      const away = game.scores?.away?.runs ?? 0;
      return `${home} - ${away}`;
    }
  },
  {
    code: 'american-football-ncaa',
    title: 'FBS College Football',
    parseScore: (game) => {
      const home = game.scores?.home ?? 0;
      const away = game.scores?.away ?? 0;
      return `${home} - ${away}`;
    }
  }
];

let currentLeagueIndex = 0;
const scoresDiv = document.getElementById('scores');

// Fetch live games for a given league
async function fetchGames(league) {
  try {
    let url = `https://v1.api-sports.io/${league.code}/fixtures?live=all`;
    
    // For NCAA/FBS, sometimes need a season param
    if(league.code === 'american-football-ncaa') {
      url += '&season=2025&league=228';
    }
    
    const res = await fetch(url, {
      headers: { 'x-apisports-key': API_KEY }
    });
    const data = await res.json();
    return data.response || [];
  } catch(e) {
    console.error(e);
    return null;
  }
}

// Render empty state
function renderEmpty(message='No live games right now.') {
  scoresDiv.innerHTML = `<div class="league-title">${LEAGUES[currentLeagueIndex].title}</div>
  <p style="font-size:1.5em;color:#777;">${message}</p>`;
}

// Render the games with logos
function renderGames(games, parseScore) {
  scoresDiv.innerHTML = `<div class="league-title">${LEAGUES[currentLeagueIndex].title}</div>`;
  if(!games.length) {
    renderEmpty();
    return;
  }

  games.forEach(game => {
    const div = document.createElement('div');
    div.className = 'game';

    const homeTeam = document.createElement('div');
    homeTeam.className = 'team';
    homeTeam.innerHTML = `<img src="${game.teams.home.logo}" alt="Home Logo"><div>${game.teams.home.name}</div>`;

    const awayTeam = document.createElement('div');
    awayTeam.className = 'team';
    awayTeam.innerHTML = `<img src="${game.teams.away.logo}" alt="Away Logo"><div>${game.teams.away.name}</div>`;

    const score = document.createElement('div');
    score.className = 'score';
    score.textContent = parseScore(game);

    div.appendChild(homeTeam);
    div.appendChild(score);
    div.appendChild(awayTeam);
    scoresDiv.appendChild(div);
  });
}

// Update scoreboard
async function updateScores() {
  const league = LEAGUES[currentLeagueIndex];
  const games = await fetchGames(league);
  if(games === null) {
    renderEmpty('Error fetching scores. Check API key or connection.');
  } else {
    renderGames(games, league.parseScore);
  }

  // Rotate to next league
  currentLeagueIndex = (currentLeagueIndex + 1) % LEAGUES.length;
}

// Initial load & interval
updateScores();
setInterval(updateScores, REFRESH_MS);
</script>
</body>
</html>